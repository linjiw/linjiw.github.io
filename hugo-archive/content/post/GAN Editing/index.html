<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h2 id="introduction">Introduction</h2> <p>In this assignment, we implement a few different techniques that require manipulating images on the manifold of natural images.</p> <ul> <li>First, we invert a pre-trained generator to find a latent variable that closely reconstructs a given real image.</li> <li>In the second part of the assignment, we take a hand-drawn sketch and generate an image that fits the sketch accordingly.</li> </ul> <h2 id="setup">Setup</h2> <p>To set up the environment for this project, create a new virtual environment and install the required dependencies:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="mi">16726</span><span class="n">_hw5</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="mi">16726</span><span class="n">_hw5</span>
<span class="n">pip3</span> <span class="n">install</span> <span class="n">torch</span><span class="o">==</span><span class="mf">1.12</span><span class="p">.</span><span class="mi">1</span><span class="o">+</span><span class="n">cu113</span> <span class="n">torchvision</span><span class="o">==</span><span class="mf">0.13</span><span class="p">.</span><span class="mi">1</span><span class="o">+</span><span class="n">cu113</span> <span class="n">torchaudio</span><span class="o">==</span><span class="mf">0.12</span><span class="p">.</span><span class="mi">1</span> <span class="o">--</span><span class="n">extra</span><span class="o">-</span><span class="n">index</span><span class="o">-</span><span class="n">url</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="p">.</span><span class="n">pytorch</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">whl</span><span class="o">/</span><span class="n">cu113</span>
<span class="n">pip3</span> <span class="n">install</span> <span class="n">click</span> <span class="n">requests</span> <span class="n">tqdm</span> <span class="n">pyspng</span> <span class="n">ninja</span> <span class="n">matplotlib</span> <span class="n">imageio</span> <span class="n">imageio</span><span class="o">-</span><span class="n">ffmpeg</span><span class="o">==</span><span class="mf">0.4</span><span class="p">.</span><span class="mi">3</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">wandb</span> <span class="c1"># weight and bias is used in this blog for logging experiments.
</span></code></pre></div></div> <h2 id="part-1-inverting-the-generator-30-pts">Part 1: Inverting the Generator [30 pts]</h2> <p>In the first part of the assignment, we solve an optimization problem to reconstruct the image from a particular latent code. We use different combinations of loss functions, generative models, and latent spaces to find the best result.</p> <h3 id="implementation-details">Implementation Details</h3> <ol> <li>Implement the forward function in the <code class="language-plaintext highlighter-rouge">Criterion</code> class.</li> <li>Implement <code class="language-plaintext highlighter-rouge">sample_noise</code> for StyleGAN2, including w and w+.</li> <li>Implement the optimization step using LBFGS or other optimizers.</li> <li>Implement the whole functionality in <code class="language-plaintext highlighter-rouge">project()</code>.</li> </ol> <h3 id="deliverables">Deliverables</h3> <p>Show example outputs of image reconstruction efforts and provide comments on why the various outputs look how they do.</p> <ul> <li>Various combinations of the losses including Lp loss, Preceptual loss and/or regularization loss that penalizes L2 norm of delta.</li> <li>different generative models including vanilla GAN, StyleGAN</li> <li>different latent space (latent code in z space, w space, and w+ space)</li> </ul> <table> <thead> <tr> <th style="text-align: center">L1 Loss</th> <th style="text-align: center">Perceptual Loss</th> <th style="text-align: center">Regularization Loss</th> <th style="text-align: center">Model</th> <th style="text-align: center">Latent Space</th> <th style="text-align: center">Results</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">Vanilla GAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">Vanilla GAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">Vanilla GAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">OFF</td> <td style="text-align: center">Vanilla GAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">Vanilla GAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">Vanilla GAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">OFF</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">z</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">OFF</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w+</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w+</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w+</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">OFF</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w+</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">ON</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w+</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">OFF</td> <td style="text-align: center">ON</td> <td style="text-align: center">OFF</td> <td style="text-align: center">StyleGAN</td> <td style="text-align: center">w+</td> <td style="text-align: center"> </td> </tr> </tbody> </table> <p>Our experiments compared <strong>GAN architectures</strong> and <strong>loss functions</strong> to assess their impact on generated images. We found that <strong>StyleGAN</strong> with <strong>L1 loss</strong>, <strong>Perceptual loss</strong>, and <strong>Regularization loss</strong> consistently delivered superior results, generating high-quality images closely resembling the target distribution.</p> <p>We observed challenges in training without <strong>Perceptual loss</strong>, resulting in less stable training processes. In contrast, <strong>Vanilla GAN</strong> generated plausible images but lacked the fine-grained detail present in <strong>StyleGAN</strong> outputs.</p> <p>In conclusion, <strong>StyleGAN</strong> combined with <strong>L1</strong>, <strong>Perceptual</strong>, and <strong>Regularization losses</strong> outperformed other configurations, demonstrating its effectiveness in generating high-quality, detailed images.</p> <h2 id="part-2-interpolate-your-cats-10-pts">Part 2: Interpolate your Cats [10 pts]</h2> <p>In this part, we perform interpolation between latent vectors found in Part 1 using different generative models and latent spaces.</p> <h3 id="implementation">Implementation</h3> <ol> <li>Implement the interpolation step in <code class="language-plaintext highlighter-rouge">interpolate()</code>.</li> </ol> <h3 id="deliverables-1">Deliverables</h3> <p>Show a few interpolations between grumpy cats and comment on the quality of the images and the interpolation process.</p> <p>We first generate in the interpolation in 64 by 64.</p> <p>But we found 64 by 64 resolution is not enough for website view experience. So we edit part of the code to enable higher resolution (512 by 512).</p> <p>And I tried to test the interpolation on some cute cats images.</p> <h2 id="part-3-scribble-to-image-40-points">Part 3: Scribble to Image [40 Points]</h2> <p>In this part, we generate an image subject to constraints, like color scribble constraints, using a penalized nonconvex optimization problem.</p> <h3 id="implementation-details-1">Implementation Details</h3> <ol> <li>Implement the code for synthesizing images from drawings to realistic ones using the optimization procedure in <code class="language-plaintext highlighter-rouge">draw()</code>.</li> </ol> <h3 id="deliverables-2">Deliverables</h3> <p>Draw some cats and experiment with sparser and denser sketches and the use of color. Show example outputs along with commentary on what seems to have happened and why.</p> <table> <thead> <tr> <th style="text-align: center">Target</th> <th style="text-align: center">Results</th> </tr> </thead> <tbody> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> </tbody> </table> <p>I also add some DIY mask for fun.</p> <table> <thead> <tr> <th style="text-align: center">Target</th> <th style="text-align: center">Results</th> </tr> </thead> <tbody> <tr> <td style="text-align: center"> </td> <td style="text-align: center"> </td> </tr> </tbody> </table> <p>Our recent experiments explored the capability of our implementation to generate <strong>intriguing images</strong> that closely conform to the <strong>target drawing masks</strong>. The results showed that our approach successfully produced visually appealing images that adhered to the provided masks.</p> <p>However, we observed that some generated images appeared dark due to the darkness of the corresponding masks. While the overall results were impressive, it’s worth noting that the <strong>mask’s darkness</strong> can impact the final image’s brightness and contrast.</p> <p>In conclusion, our experiments demonstrated that our implementation could effectively generate interesting images that align with the target drawing masks, though the mask’s darkness may <strong>influence the resulting image’s appearance</strong>.</p> <h2 id="conlusions">Conlusions</h2> <p>Throughout this project, we have investigated various aspects of image generation using <strong>GAN architectures</strong>. 🖼️</p> <p><strong>Part 1</strong> focused on comparing different GAN architectures and loss functions, where <strong>StyleGAN</strong> with <strong>L1 loss</strong>, <strong>Perceptual loss</strong>, and <strong>Regularization loss</strong> proved to be the most effective in generating high-quality, detailed images. We also observed challenges in training without <strong>Perceptual loss</strong> 😅, and found that <strong>Vanilla GAN</strong> could not match the fine-grained detail present in <strong>StyleGAN</strong> outputs.</p> <p>In <strong>Part 2</strong>, we showcased several interpolations between grumpy cat images 🐱, initially at a resolution of 64x64, which was later increased to 512x512 for a better web viewing experience. The interpolations demonstrated the smooth transitions between images and highlighted the potential of high-resolution image generation 🌟.</p> <p><strong>Part 3</strong> explored generating intriguing images that closely conform to target drawing masks ✍️. While our implementation successfully produced visually appealing images, we observed that the mask’s darkness could impact the final image’s brightness and contrast.</p> <p>Overall, this project has demonstrated the power of GANs, particularly <strong>StyleGAN</strong>, in generating high-quality images and interpolations 🔥. We have also shown the potential of using target drawing masks for image generation, opening up possibilities for further exploration and improvement in image manipulation techniques 💡.</p> </body></html>