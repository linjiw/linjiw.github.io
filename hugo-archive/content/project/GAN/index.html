<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h2 id="introduction">Introduction</h2> <p>In this assignment, we get hands-on experience coding and training GANs. This assignment includes two parts:</p> <p>Implementing a Deep Convolutional GAN (DCGAN) to generate grumpy cats from samples of random noise. Implementing a more complex GAN architecture called CycleGAN for the task of image-to-image translation. We train the CycleGAN to convert between different types of two kinds of cats (Grumpy and Russian Blue) and between apples and oranges.</p> <h2 id="part-1-deep-convolutional-gan">Part 1: Deep Convolutional GAN</h2> <p>For the first part of this assignment, we implement a slightly modified version of Deep Convolutional GAN (DCGAN).</p> <h3 id="implement-data-augmentation">Implement Data Augmentation</h3> <p>Implemented the deluxe version of data augmentation in ‘data_loader.py’.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">elif</span> <span class="n">opts</span><span class="p">.</span><span class="n">data_preprocess</span> <span class="o">==</span> <span class="sh">'</span><span class="s">deluxe</span><span class="sh">'</span><span class="p">:</span>
        <span class="n">load_size</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="mf">1.1</span> <span class="o">*</span> <span class="n">opts</span><span class="p">.</span><span class="n">image_size</span><span class="p">)</span>
        <span class="n">osize</span> <span class="o">=</span> <span class="p">[</span><span class="n">load_size</span><span class="p">,</span> <span class="n">load_size</span><span class="p">]</span>
        <span class="n">deluxe_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">([</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">Resize</span><span class="p">(</span><span class="n">opts</span><span class="p">.</span><span class="n">image_size</span><span class="p">,</span> <span class="n">Image</span><span class="p">.</span><span class="n">BICUBIC</span><span class="p">),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">RandomCrop</span><span class="p">(</span><span class="n">opts</span><span class="p">.</span><span class="n">image_size</span><span class="p">),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">RandomHorizontalFlip</span><span class="p">(),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">ToTensor</span><span class="p">(),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)),</span>
        <span class="p">])</span>
        <span class="n">train_transform</span> <span class="o">=</span> <span class="n">deluxe_transform</span>
    <span class="k">pass</span>
</code></pre></div></div> <h3 id="implement-the-discriminator-of-the-dcgan">Implement the Discriminator of the DCGAN</h3> <p>(Answer for padding calculation goes here)</p> <p>Implemented the architecture by filling in the ‘<strong>init</strong>’ and ‘forward’ method of the ‘DCDiscriminator’ class in ‘models.py’.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">conv_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">instance</span><span class="sh">'</span><span class="p">):</span>
    <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">()</span>
    <span class="n">self</span><span class="p">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="nf">conv</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="nf">conv</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">conv3</span> <span class="o">=</span> <span class="nf">conv</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">conv4</span> <span class="o">=</span> <span class="nf">conv</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">conv5</span> <span class="o">=</span> <span class="nf">conv</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Forward pass, x is (B, C, H, W).</span><span class="sh">"""</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">conv3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">conv4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">conv5</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">.</span><span class="nf">squeeze</span><span class="p">()</span>
</code></pre></div></div> <h3 id="generator">Generator</h3> <p>Implemented the generator of the DCGAN by filling in the ‘<strong>init</strong>’ and ‘forward’ method of the ‘DCGenerator’ class in ‘models.py’.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">noise_size</span><span class="p">,</span> <span class="n">conv_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">):</span>
    <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">()</span>

    <span class="n">self</span><span class="p">.</span><span class="n">up_conv1</span> <span class="o">=</span> <span class="nf">conv</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">'</span><span class="s">instance</span><span class="sh">'</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span> <span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">up_conv2</span> <span class="o">=</span> <span class="nf">up_conv</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">instance</span><span class="sh">'</span><span class="p">,</span> <span class="n">activ</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">up_conv3</span> <span class="o">=</span> <span class="nf">up_conv</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">instance</span><span class="sh">'</span><span class="p">,</span> <span class="n">activ</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">up_conv4</span> <span class="o">=</span> <span class="nf">up_conv</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">instance</span><span class="sh">'</span><span class="p">,</span> <span class="n">activ</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">up_conv5</span> <span class="o">=</span> <span class="nf">up_conv</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">activ</span><span class="o">=</span><span class="sh">'</span><span class="s">tanh</span><span class="sh">'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Generate an image given a sample of random noise.

    Input
    -----
        z: BS x noise_size x 1 x 1   --&gt;  16x100x1x1

    Output
    ------
        out: BS x channels x image_width x image_height  --&gt;  16x3x64x64
    </span><span class="sh">"""</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">up_conv1</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">up_conv2</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">up_conv3</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">up_conv4</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">up_conv5</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">z</span>
</code></pre></div></div> <h3 id="training-loop">Training Loop</h3> <p>Implemented the training loop for the DCGAN by filling in the indicated parts of the training_loop function in vanilla_gan.py.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="c1"># TRAIN THE DISCRIMINATOR
</span>            <span class="c1"># 1. Compute the discriminator loss on real images
</span>            <span class="k">if</span> <span class="n">opts</span><span class="p">.</span><span class="n">use_diffaug</span><span class="p">:</span>
                <span class="n">D_real_loss</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">mean</span><span class="p">((</span><span class="nc">D</span><span class="p">(</span><span class="nc">DiffAugment</span><span class="p">(</span><span class="n">real_images</span><span class="p">,</span> <span class="n">policy</span><span class="o">=</span><span class="sh">'</span><span class="s">color,translation,cutout</span><span class="sh">'</span><span class="p">,</span> <span class="n">channels_first</span><span class="o">=</span><span class="bp">False</span> <span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">D_real_loss</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">mean</span><span class="p">((</span><span class="nc">D</span><span class="p">(</span><span class="n">real_images</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>


            <span class="c1"># 2. Sample noise
</span>            <span class="n">noise</span> <span class="o">=</span> <span class="nf">sample_noise</span><span class="p">(</span><span class="n">opts</span><span class="p">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">opts</span><span class="p">.</span><span class="n">noise_size</span><span class="p">)</span>

            <span class="c1"># 3. Generate fake images from the noise
</span>            <span class="n">fake_images</span> <span class="o">=</span> <span class="nc">G</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>

            <span class="c1"># 4. Compute the discriminator loss on the fake images
</span>            <span class="k">if</span> <span class="n">opts</span><span class="p">.</span><span class="n">use_diffaug</span><span class="p">:</span>

                <span class="n">D_fake_loss</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">mean</span><span class="p">((</span><span class="nc">D</span><span class="p">(</span><span class="nc">DiffAugment</span><span class="p">(</span><span class="n">fake_images</span><span class="p">.</span><span class="nf">detach</span><span class="p">(),</span> <span class="n">policy</span><span class="o">=</span><span class="sh">'</span><span class="s">color,translation,cutout</span><span class="sh">'</span><span class="p">,</span> <span class="n">channels_first</span><span class="o">=</span><span class="bp">False</span> <span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">D_real_loss</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">mean</span><span class="p">((</span><span class="nc">D</span><span class="p">(</span><span class="n">fake_images</span><span class="p">.</span><span class="nf">detach</span><span class="p">()))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">D_total_loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">D_real_loss</span> <span class="o">+</span> <span class="n">D_fake_loss</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

            <span class="c1"># update the discriminator D
</span>            <span class="n">d_optimizer</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
            <span class="n">D_total_loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>
            <span class="n">d_optimizer</span><span class="p">.</span><span class="nf">step</span><span class="p">()</span>

            <span class="c1"># TRAIN THE GENERATOR
</span>            <span class="c1"># 1. Sample noise
</span>            <span class="n">noise</span> <span class="o">=</span> <span class="nf">sample_noise</span><span class="p">(</span><span class="n">opts</span><span class="p">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">opts</span><span class="p">.</span><span class="n">noise_size</span><span class="p">)</span>

            <span class="c1"># 2. Generate fake images from the noise
</span>            <span class="n">fake_images</span> <span class="o">=</span> <span class="nc">G</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>

            <span class="c1"># 3. Compute the generator loss
</span>            <span class="k">if</span> <span class="n">opts</span><span class="p">.</span><span class="n">use_diffaug</span><span class="p">:</span>
                <span class="n">G_loss</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">mean</span><span class="p">((</span><span class="nc">D</span><span class="p">(</span><span class="nc">DiffAugment</span><span class="p">(</span><span class="n">fake_images</span><span class="p">,</span> <span class="n">policy</span><span class="o">=</span><span class="sh">'</span><span class="s">color,translation,cutout</span><span class="sh">'</span><span class="p">,</span> <span class="n">channels_first</span><span class="o">=</span><span class="bp">False</span> <span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">G_loss</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">mean</span><span class="p">((</span><span class="nc">D</span><span class="p">(</span><span class="n">fake_images</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

</code></pre></div></div> <h4 id="differentiable-augmentation">Differentiable Augmentation</h4> <p>(Discussion of results with and without applying differentiable augmentations, and the difference between two augmentation schemes in terms of implementation and effects)</p> <h3 id="experiment-with-dcgans">Experiment with DCGANs</h3> <p>INSERT IMAGE: Screenshots of discriminator and generator training loss with –data_preprocess=basic, –data_preprocess=deluxe.</p> <p>(Brief explanation of what the curves should look like if GAN manages to train)</p> <p>INSERT IMAGE: With –data_preprocess=deluxe and differentiable augmentation enabled, show one of the samples from early in training (e.g., iteration 200) and one of the samples from later in training, and give the iteration number for those samples.</p> <p>(Brief comment on the quality of the samples, and in what way they improve through training)</p> <h2 id="part-2-cyclegan">Part 2: CycleGAN</h2> <p>Implemented the CycleGAN architecture.</p> <h3 id="data-augmentation">Data Augmentation</h3> <p>Set the –data_preprocess flag to deluxe.</p> <h3 id="generator-1">Generator</h3> <p>Implemented the generator architecture by completing the <strong>init</strong> method of the CycleGenerator class in models.py.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">conv_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">init_zero_weights</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">instance</span><span class="sh">'</span><span class="p">):</span>
    <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">()</span>

    <span class="c1"># # 1. Define the encoder part of the generator
</span>    <span class="n">self</span><span class="p">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="nf">conv</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="nf">conv</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>

    <span class="c1"># # 2. Define the transformation part of the generator
</span>    <span class="n">self</span><span class="p">.</span><span class="n">resnet_block</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Sequential</span><span class="p">(</span><span class="nc">ResnetBlock</span><span class="p">(</span><span class="n">conv_dim</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">,</span> <span class="n">activ</span> <span class="o">=</span> <span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">),</span>
                                      <span class="nc">ResnetBlock</span><span class="p">(</span><span class="n">conv_dim</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">,</span> <span class="n">activ</span> <span class="o">=</span> <span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">),</span>
                                      <span class="nc">ResnetBlock</span><span class="p">(</span><span class="n">conv_dim</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">,</span> <span class="n">activ</span> <span class="o">=</span> <span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">),)</span>

    <span class="c1"># # 3. Define the decoder part of the generator
</span>    <span class="n">self</span><span class="p">.</span><span class="n">up_conv1</span> <span class="o">=</span> <span class="nf">up_conv</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">instance</span><span class="sh">'</span><span class="p">,</span> <span class="n">activ</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">up_conv2</span> <span class="o">=</span> <span class="nf">up_conv</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">activ</span><span class="o">=</span><span class="sh">'</span><span class="s">tanh</span><span class="sh">'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Generate an image conditioned on an input image.

    Input
    -----
        x: BS x 3 x 32 x 32

    Output
    ------
        out: BS x 3 x 32 x 32
    </span><span class="sh">"""</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">resnet_block</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">up_conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">up_conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></div> <h3 id="training-loop-1">Training Loop</h3> <p>Implemented the training loop for the CycleGAN by filling in the indicated parts of the training_loop function in cycle_gan.py.</p> <h3 id="experiment-with-cyclegan">Experiment with CycleGAN</h3> <p>INSERT IMAGE: Two example images of generated Grumpy cats from Russian Blue cats, and two example images of generated Russian Blue cats from Grumpy cats.</p> <p>(Brief comment on the quality of the generated images, and whether the CycleGAN has captured the main differences between the two domains)</p> <p>INSERT IMAGE: Two example images of generated apples from oranges, and two example images of generated oranges from apples.</p> <p>(Brief comment on the quality of the generated images, and whether the CycleGAN has captured the main differences between the two domains)</p> <h2 id="conclusion">Conclusion</h2> <p>This report presents our implementation of DCGAN and CycleGAN for various image generation tasks. Through these experiments, we have observed the impact of data augmentation and differentiable augmentation on the training process and final results. We have also seen the capabilities of CycleGAN in generating realistic images for domain-to-domain translation tasks, such as converting Grumpy cats to Russian Blue cats and vice versa, and converting apples to oranges and vice versa.</p> </body></html>